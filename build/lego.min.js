!function(t){var i={extend:function(t,i,e){t.prototype=Object.create(i.prototype),t.superClass=i,e&&this.merge(t.prototype,e)},merge:function(t,i){for(var e in i)t[e]=i[e]},to2d:function(t){var i=1e3,e=i/(i-t.z);return{x:275+t.x*e,y:200+t.y*e}}};t.lego=i}(this),function(){var t={create:function(){return[0,0,0]}};lego.Vector3=t}(this),function(){var t=lego.Vector3,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e={create:function(){return i.concat()},clone:function(t){return t.concat()},setIdentity:function(t){this.set(t,i)},set:function(t,i){for(var e=0;16>e;e++)t[e]=i[e]},concat:function(t,i){var e,n,s,o,r,a,h,c;for(n=t,s=t,o=i,n===o&&(o=this.clone(n)),e=0;4>e;e++)r=s[e],a=s[e+4],h=s[e+8],c=s[e+12],n[e]=r*o[0]+a*o[1]+h*o[2]+c*o[3],n[e+4]=r*o[4]+a*o[5]+h*o[6]+c*o[7],n[e+8]=r*o[8]+a*o[9]+h*o[10]+c*o[11],n[e+12]=r*o[12]+a*o[13]+h*o[14]+c*o[15]},multiplyVector3:function(i,e){var n=t.create();return n[0]=e[0]*i[0]+e[1]*i[4]+e[2]*i[8]+i[12],n[1]=e[0]*i[1]+e[1]*i[5]+e[2]*i[9]+i[13],n[2]=e[0]*i[2]+e[1]*i[6]+e[2]*i[10]+i[14],n},transpose:function(t){var i;i=t[1],t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[3],t[3]=t[12],t[12]=i,i=t[6],t[6]=t[9],t[9]=i,i=t[7],t[7]=t[13],t[13]=i,i=t[11],t[11]=t[14],t[14]=i},setScale:function(t,i,e,n){t[0]=i,t[4]=0,t[8]=0,t[12]=0,t[1]=0,t[5]=e,t[9]=0,t[13]=0,t[2]=0,t[6]=0,t[10]=n,t[14]=0,t[3]=0,t[7]=0,t[11]=0,t[15]=1},scale:function(t,i,e,n){t[0]*=i,t[4]*=e,t[8]*=n,t[1]*=i,t[5]*=e,t[9]*=n,t[2]*=i,t[6]*=e,t[10]*=n,t[3]*=i,t[7]*=e,t[11]*=n},setTranslate:function(t,i,e,n){t[0]=1,t[4]=0,t[8]=0,t[12]=i,t[1]=0,t[5]=1,t[9]=0,t[13]=e,t[2]=0,t[6]=0,t[10]=1,t[14]=n,t[3]=0,t[7]=0,t[11]=0,t[15]=1},translate:function(t,i,e,n){t[12]+=t[0]*i+t[4]*e+t[8]*n,t[13]+=t[1]*i+t[5]*e+t[9]*n,t[14]+=t[2]*i+t[6]*e+t[10]*n,t[15]+=t[3]*i+t[7]*e+t[11]*n},setRotate:function(t,i,e,n,s){var o,r,a,h,c,l,v,u,f,p,d;i=Math.PI*i/180,o=Math.sin(i),r=Math.cos(i),0!==e&&0===n&&0===s?(0>e&&(o=-o),t[0]=1,t[4]=0,t[8]=0,t[12]=0,t[1]=0,t[5]=r,t[9]=-o,t[13]=0,t[2]=0,t[6]=o,t[10]=r,t[14]=0,t[3]=0,t[7]=0,t[11]=0,t[15]=1):0===e&&0!==n&&0===s?(0>n&&(o=-o),t[0]=r,t[4]=0,t[8]=o,t[12]=0,t[1]=0,t[5]=1,t[9]=0,t[13]=0,t[2]=-o,t[6]=0,t[10]=r,t[14]=0,t[3]=0,t[7]=0,t[11]=0,t[15]=1):0===e&&0===n&&0!==s?(0>s&&(o=-o),t[0]=r,t[4]=-o,t[8]=0,t[12]=0,t[1]=o,t[5]=r,t[9]=0,t[13]=0,t[2]=0,t[6]=0,t[10]=1,t[14]=0,t[3]=0,t[7]=0,t[11]=0,t[15]=1):(a=Math.sqrt(e*e+n*n+s*s),1!==a&&(h=1/a,e*=h,n*=h,s*=h),c=1-r,l=e*n,v=n*s,u=s*e,f=e*o,p=n*o,d=s*o,t[0]=e*e*c+r,t[1]=l*c+d,t[2]=u*c-p,t[3]=0,t[4]=l*c-d,t[5]=n*n*c+r,t[6]=v*c+f,t[7]=0,t[8]=u*c+p,t[9]=v*c-f,t[10]=s*s*c+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1)},rotate:function(t,i,e,n,s){var o=this.create();this.setRotate(o,i,e,n,s),this.concat(t,o)}};lego.Matrix4=e}(this),function(t){var i=t.lego,e=i.Matrix4,n=(i.Vector3,function(t){this.x=0,this.y=0,this.z=0,this.pivotX=0,this.pivotY=0,this.pivotZ=0,this.scaleX=1,this.scaleY=1,this.scaleZ=1,this.rotationX=0,this.rotationY=0,this.rotationZ=0,this.mat=e.create(),this.alpha=1,this.visible=!0,this.parent=null,this.children=[],i.merge(this,t)});i.merge(n.prototype,{addChild:function(t){t.removeFromParent(),this.children.indexOf(t)<0&&(this.children.push(t),t.parent=this)},removeChild:function(t){var i=this.children.indexOf(t);i>-1&&(t.parent=null,this.children.splice(i,1))},removeFromParent:function(){var t=this.parent;t&&t.removeChild(this)},render:function(t,i){var e=this.children;this.onUpdate&&this.onUpdate(i);for(var n=0,s=e.length;s>n;n++){var o=e[n];o.render(t,i)}t.save(),this._transform(t),this._draw(t),t.restore()},getVector:function(){for(var i=e.create(),n=this.parent;n;){var s=e.create();e.translate(s,n.x,n.y,n.z),e.rotate(s,n.rotationY,0,1,0),e.rotate(s,n.rotationX,1,0,0),e.rotate(s,n.rotationZ,0,0,1),e.scale(s,n.scaleX,n.scaleY,n.scaleZ),e.translate(s,-n.pivotX,-n.pivotY,n.z),e.concat(i,s),n=n.parent}return t.finalMat=i,e.multiplyVector3(i,[this.x,this.y,this.z])},_transform:function(){var t=this.getVector(),e=i.to2d({x:t[0],y:t[1],z:t[2]});this._pos=e},_draw:function(){}}),i.View=n}(this),function(t){var i=t.lego,e=i.View,n=function(t){this.canvas=null,this.ctx=null,e.call(this,t),this._init()};i.extend(n,e,{_lastTime:0,_init:function(){this.canvas||(this.canvas=document.createElement("canvas"),document.body.appendChild(this.canvas)),this.ctx=this.canvas.getContext("2d"),this.resize(this.width,this.height)},_tick:function(){var t=+new Date,i=this.ctx;i.clearRect(0,0,this.width,this.height),i.moveTo(0,200),i.lineTo(550,200),i.moveTo(275,200),i.lineTo(275,0),i.stroke(),this.render(i,t-this._lastTime),this._lastTime=t},start:function(t){var i=this;this.interval=setInterval(function(){i._tick()},1e3/t),this._lastTime=+new Date,i._tick()},stop:function(){clearInterval(this.interval)},resize:function(t,i){this.width=t,this.height=i,this.canvas.width=t,this.canvas.height=i}}),i.Stage=n}(this),function(t){var i=t.lego,e=i.View,n=function(t){this.points=[],this.views=[],e.call(this,t),this.init()};i.extend(n,e,{init:function(){for(var t=0,i=this.points.length;i>t;t++){var n=new e(this.points[t]);this.views.push(n),this.addChild(n),n._draw=function(t){var i=10;t.beginPath(),t.arc(this._pos.x,this._pos.y,i,0,2*Math.PI),t.stroke()}}},_render:function(){},_draw:function(t){t.beginPath();var i={x:0,y:0};t.moveTo(this.views[0]._pos.x-i.x,this.views[0]._pos.y-i.y);for(var e=1,n=this.views.length;n>e;e++)t.lineTo(this.views[e]._pos.x-i.x,this.views[e]._pos.y-i.y);t.lineTo(this.views[0]._pos.x-i.x,this.views[0]._pos.y-i.y),t.stroke()}}),i.Group=n}(this);